geom_histogram(bins = 500) +
labs(main = "p-values") +
ggtitle("Distribution of positive selection p-values")
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab(main = "p-value") +
ggtitle("Distribution of positive selection p-values")
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of positive selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point()
# Distribution of positive selection p-values
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of positive selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
geom_abline(mapping = aes(x = 0.05)) +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
geom_vline(xintercept = 0.05,
linetype = "dashed",
color = "red") +
geom_hline(yintercept = 0.05,
linetype = "dashed",
color = "red") +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
linetype = "dashed",
color = "red") +
geom_hline(yintercept = 0.05,
linetype = "dashed",
color = "red") +
ggtitle("Comparison of positive and negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01,
legend = FALSE)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values") +
theme(legend.position="none")
histogram(mageck$pos.fdr)
####  False Discovery Rates
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values") +
theme(legend.position="none")
# Distribution of positive selection fdr
ggplot(mageck, aes(x = pos.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of positive selection fdr values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of negative selection fdr values")
head(pathways)
head(gmt2)
View(mageck)
# Compare positive and negative lfc
ggplot(mageck, aes(x = neg.lfc,
y = pos.lfc,
alpha = 0.01)) +
geom_point() +
ggtitle("Comparison of positive and negative selection log fold change") +
theme(legend.position="none")
# Distribution of positive selection lfc
ggplot(mageck, aes(x = pos.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of positive selection log fold change")
# Distribution of negative selection lfc
ggplot(mageck, aes(x = neg.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of negative selection log fold change")
# Distribution of lfc (positive and negative values the same)
ggplot(mageck, aes(x = pos.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of log fold change for all genes")
qqplot(mageck$pos.lfc)
qqnorm(mageck$pos.lfc, name = "Normality of log fold change")
qqnorm(mageck$pos.lfc, name = "Normality of log fold change")
qqline(mageck$pos.lfc)
qqnorm(mageck$pos.lfc, main = "Normality of log fold change")
qqline(mageck$pos.lfc)
# Convert goodsgrna to factor
mageck$num <- as.factor(mageck$num)
# view data summary
summary(mageck)
?geom_bar
### number of sgRNA's
ggplot(mageck, mapping = aes(num)) +
geom_bar(fill = num)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar(fill = num)
# Convert goodsgrna to factor
mageck$num <- as.factor(mageck$num)
mageck$neg.goodsgrna <- as.factor(mageck$neg.goodsgrna)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar(fill = num)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_col(fill = num)
### number of sgRNA's
ggplot(mageck, aes(mageck$num)) +
geom_col(fill = mageck$num)
### number of sgRNA's
ggplot(mageck, aes(mageck$num)) +
geom_bar(fill = mageck$num)
### number of sgRNA's
ggplot(mageck, aes(mageck$num)) +
geom_bar()
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar()
### goodsgrna
# positive selection
ggplot(mageck, aes(pos.goodsgrna)) +
geom_bar()
# negative selection
ggplot(mageck, aes(neg.goodsgrna)) +
geom_bar()
# view data summary
summary(mageck)
# negative selection
ggplot(mageck, aes(neg.goodsgrna)) +
geom_bar(fill = neg.goodsgrna)
library(ggplot2)
#### p-values
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values") +
theme(legend.position="none")
# Distribution of positive selection p-values
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of positive selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
####  False Discovery Rates
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values") +
theme(legend.position="none")
# Distribution of positive selection fdr
ggplot(mageck, aes(x = pos.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of positive selection fdr values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of negative selection fdr values")
#### log fold change
# Distribution of lfc (positive and negative values the same)
ggplot(mageck, aes(x = pos.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of log fold change for all genes")
# Check normality of variable
qqnorm(mageck$pos.lfc, main = "Normality of log fold change")
qqline(mageck$pos.lfc)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar() +
ggtitle("Distribution of number of guide RNAs used")
### goodsgrna
# positive selection
ggplot(mageck, aes(pos.goodsgrna)) +
geom_bar() +
ggtitle("Distribution of negative selection `goodsgrna`")
# negative selection
ggplot(mageck, aes(neg.goodsgrna)) +
geom_bar() +
ggtitle("Distribution of negative selection `goodsgrna`")
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count') +
ggtitle("Distribution of number of guide RNAs used")
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count', aes(label = after_stat(count))) +
ggtitle("Distribution of number of guide RNAs used")
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -1) +
ggtitle("Distribution of number of guide RNAs used")
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
ggtitle("Distribution of number of guide RNAs used")
library(ggplot2)
#### p-values
# Distribution of positive selection p-values
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of positive selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values") +
theme(legend.position="none")
####  False Discovery Rates
# Distribution of positive selection fdr
ggplot(mageck, aes(x = pos.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of positive selection fdr values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of negative selection fdr values")
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values") +
theme(legend.position="none")
#### log fold change
# Distribution of lfc (positive and negative values the same)
ggplot(mageck, aes(x = pos.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of log fold change for all genes")
# Check normality of variable
qqnorm(mageck$pos.lfc, main = "Normality of log fold change")
qqline(mageck$pos.lfc)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of number of guide RNAs used")
### goodsgrna
# positive selection
ggplot(mageck, aes(pos.goodsgrna)) +
geom_bar(aes(fill = pos.goodsgrna)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of negative selection `goodsgrna`")
# negative selection
ggplot(mageck, aes(neg.goodsgrna)) +
geom_bar(aes(fill = neg.goodsgrna)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of negative selection `goodsgrna`")
library(ggplot2)
#### p-values
# Distribution of positive selection p-values
ggplot(mageck, aes(x = pos.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of positive selection p-values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.p_value)) +
geom_histogram(bins = 500) +
xlab("p-value") +
ggtitle("Distribution of negative selection p-values")
# Compare positive and negative p-values
ggplot(mageck, aes(x = neg.p_value,
y = pos.p_value,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.05,
color = "red") +
geom_hline(yintercept = 0.05,
color = "red") +
ggtitle("Comparison of positive and negative selection p-values") +
theme(legend.position="none")
####  False Discovery Rates
# Distribution of positive selection fdr
ggplot(mageck, aes(x = pos.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of positive selection fdr values")
# Distribution of negative selection p-values
ggplot(mageck, aes(x = neg.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of negative selection fdr values")
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values") +
theme(legend.position="none")
#### log fold change
# Distribution of lfc (positive and negative values the same)
ggplot(mageck, aes(x = pos.lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of log fold change for all genes")
# Check normality of variable
qqnorm(mageck$pos.lfc, main = "Normality of log fold change")
qqline(mageck$pos.lfc)
### number of sgRNA's
ggplot(mageck, aes(num)) +
geom_bar(aes(fill = num)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of number of guide RNAs used")
### goodsgrna
# positive selection
ggplot(mageck, aes(pos.goodsgrna)) +
geom_bar(aes(fill = pos.goodsgrna)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of negative selection `goodsgrna`")
# negative selection
ggplot(mageck, aes(neg.goodsgrna)) +
geom_bar(aes(fill = neg.goodsgrna)) +
geom_text(stat = 'count',
aes(label = after_stat(count)),
vjust = -0.5) +
ggtitle("Distribution of negative selection `goodsgrna`")
source[1]
str(pathwasy)
str(pathways)
str(pathways$BIOCARTA_RELA_PATHWAY)
class(pathways$BIOCARTA_RELA_PATHWAY)
library(ggplot2)
library(corrplot)
knitr::opts_chunk$set(echo = TRUE)
cor.crispr <- cor(mageck)
cor.crispr <- cor(mageck)
?cor
str(mageck)
cor.crispr <- cor(mageck[,2:14])
cor.crispr <- cor(as.numeric(mageck[,2:14]))
cor.crispr <- cor(mageck[-(1,2,7,13),])
cor.crispr <- cor(mageck[,-(1,2,7,13)])
cor.crispr <- cor(mageck[,-(1:2,7,13)])
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(method = "color")
corrplot(cor.crispr,
method = "color")
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$neg.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
abline(mageck$pos.fdr ~ mageck$pos.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
abline(mageck$pos.fdr ~ mageck$pos.lfc)
?abline
plot(mageck$pos.fdr,
mageck$pos.lfc)
abline()
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$neg.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$neg.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
plot(mageck$neg.rank,
mageck$pos.lfc)
plot(mageck$pos.rank,
mageck$pos.lfc)
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$neg.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
plot(mageck$neg.rank,
mageck$pos.lfc)
plot(mageck$pos.rank,
mageck$pos.lfc)
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$neg.lfc)
plot(mageck$pos.fdr,
mageck$pos.lfc)
plot(mageck$neg.rank,
mageck$pos.lfc)
plot(mageck$pos.rank,
mageck$pos.lfc)
hist(mageck$neg.lfc)
