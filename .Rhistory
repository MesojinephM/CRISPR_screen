print(mageck$neg.p_value[i])
selection[i] <- "negative"
} else if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "equal"
}
}
print(mageck$neg.p_value[i])
for (i in length(mageck$id)){
if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
print(mageck$neg.p_value[i])
selection[i] <- "positive"
} else {
selection[i] <- "equal"
}
}
str(selection)
length(mageck$id)
selection[1] <- "negative"
str(selection)
if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else {
selection[i] <- "positive"
}
for (i in length(mageck$id)){
if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else {
selection[i] <- "positive"
}
}
str(selection)
selection <- rep(NULL, length(mageck$id))
str(selection)
for (i in length(mageck$id)){
if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else {
selection[i] <- "positive"
}
}
str(selection)
for (i in length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
str(selection)
for (i in length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
str(mageck)
if (mageck["neg.p_value",i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
$
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
selection[1] <- "negative"
if (mageck$neg.p_value[1] > mageck$pos.p_value[1]){
selection[1] <- "positive"
} else {
selection[1] <- "negative"
}
selection[1]
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[1] > mageck$pos.p_value[1]){
selection[1] <- "positive"
} else {
selection[1] <- "negative"
}
}
str(selection)
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[1] > mageck$pos.p_value[1]){
selection[1] <- "positive"
} else {
selection[1] <- "negative"
}
}
str(selection)
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
str(selection)
mageck$selection <- as.factor(selection)
summary(mageck$selection)
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else {
selection[i] <- "neither"
}
}
mageck$selection <- as.factor(selection)
summary(mageck$selection)
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else if (mageck$neg.p_value[i] < mageck$pos.p_value[i]){
selection[i] <- "negative"
} else {
selection[i] <- "neither"
}
}
mageck$selection <- as.factor(selection)
summary(mageck$selection)
# Create separate data frames for each positive and negative selection
positives <- filter(mageck, mageck$selection == "positive")
str(positives)
head(positives)
head(mageck)
# Create separate data frames for each positive and negative selection
positives <- mageck[mageck$selection == "positive",]
head(positives)
negatives <- mageck[mageck$selection == "negative",]
head(negatives)
# Create separate data frames for each positive and negative selection
positives <- mageck[mageck$selection == "positive", -mageck$selection]
# Create separate data frames for each positive and negative selection
positives <- mageck[mageck$selection == "positive", -selection]
# Create separate data frames for each positive and negative selection
positives <- mageck[mageck$selection == "positive", -c("selection")]
# Create separate data frames for each positive and negative selection
positives <- mageck[mageck$selection == "positive", -15]
negatives <- mageck[mageck$selection == "negative", -15]
str(positives)
# Compare lfc in both groups
hist(positives$pos.lfc)
# Compare lfc in both groups
layout(1,2)
layout(1,2)
hist(positives$pos.lfc)
hist(negatives$neg.lfc)
layout(2,1)
# Compare lfc in both groups
hist(positives$pos.lfc)
hist(negatives$neg.lfc)
# Compare lfc in both groups
hist(positives$pos.lfc)
hist(negatives$neg.lfc)
summary(positives$pos.lfc)
summary(negatives$neg.lfc)
library(ggridges)
install.packages("ggridges")
library(ggridges)
?geom_density_ridges
# Compare lfc across selections
ggplot(mageck, mapping = aes(pos.lfc, group = selection)) +
geom_histogram()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
y = selection,
group = selection)) +
geom_ensity_ridges()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
y = selection,
group = selection)) +
geom_density_ridges()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
y = selection,
group = selection,
color = selection)) +
geom_density_ridges()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
y = selection,
group = selection,
fill = selection)) +
geom_density_ridges()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
group = selection,
fill = selection)) +
geom_density()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
group = selection,
fill = selection,
alpha = 0.05)) +
geom_density()
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = pos.lfc,
group = selection,
fill = selection,
alpha = 0.05)) +
geom_density() +
ggtitle("Log fold change distribution for positive and negative selections")
# Reassign column names
colnames(mageck) <- c("id",
"num",
"neg.score",
"neg.p_value",
"neg.fdr",
"neg.rank",
"neg.goodsgrna",
"neg.lfc",
"pos.score",
"pos.p_value",
"pos.fdr",
"pos.rank",
"pos.goodsgrna",
"lfc"
)
# Convert goodsgrna to factor
mageck$num <- as.factor(mageck$num)
mageck$neg.goodsgrna <- as.factor(mageck$neg.goodsgrna)
mageck$pos.goodsgrna <- as.factor(mageck$pos.goodsgrna)
# Delete neg.lfc
mageck <- mageck[,-8]
# view data summary
summary(mageck)
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,12)])
cor.crispr <- cor(mageck[,-c(1,2,7,13)])
head(mageck[,c(1, 2, 7, 13)])
head(mageck[,c(1, 2, 7, 12)])
# Import MAGeCK data set
library(readr)
library(ggplot2)
mageck <- read_delim("mageckRRA.gene_summary.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
# Reassign column names
colnames(mageck) <- c("id",
"num",
"neg.score",
"neg.p_value",
"neg.fdr",
"neg.rank",
"neg.goodsgrna",
"neg.lfc",
"pos.score",
"pos.p_value",
"pos.fdr",
"pos.rank",
"pos.goodsgrna",
"lfc"
)
# Convert goodsgrna to factor
mageck$num <- as.factor(mageck$num)
mageck$neg.goodsgrna <- as.factor(mageck$neg.goodsgrna)
mageck$pos.goodsgrna <- as.factor(mageck$pos.goodsgrna)
# Delete neg.lfc
mageck <- mageck[,-8]
# view data summary
summary(mageck)
#### log fold change
# Distribution of lfc (positive and negative values the same)
ggplot(mageck, aes(x = lfc)) +
geom_histogram(bins = 500) +
xlab("lfc") +
ggtitle("Distribution of log fold change for all genes")
# Check normality of variable
qqnorm(mageck$lfc, main = "Normality of log fold change")
qqline(mageck$lfc)
# Create correlation plot
library(corrplot)
cor.crispr <- cor(mageck[,-c(1,2,7,12)])
corrplot(cor.crispr,
method = "color")
# Plot lfc with pos and neg fdr
plot(mageck$neg.fdr,
mageck$lfc)
plot(mageck$pos.fdr,
mageck$lfc)
plot(mageck$neg.rank,
mageck$lfc)
plot(mageck$pos.rank,
mageck$lfc)
hist(mageck$lfc)
library(ggridges)
# Sort values based on p-values to see which selection p-value is lower
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
# Append to mageck data frame as factor
mageck$selection <- as.factor(selection)
summary(mageck$selection)
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = lfc,
group = selection,
fill = selection,
alpha = 0.05)) +
geom_density() +
ggtitle("Log fold change distribution for positive and negative selections")
# Create separate data frames for each positive and negative selection
#  and remove selection variable from each
positives <- mageck[mageck$selection == "positive", -15]
library(ggridges)
# Sort values based on p-values to see which selection p-value is lower
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
# Append to mageck data frame as factor
mageck$selection <- as.factor(selection)
summary(mageck$selection)
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = lfc,
group = selection,
fill = selection,
alpha = 0.05)) +
geom_density() +
ggtitle("Log fold change distribution for positive and negative selections")
# Create separate data frames for each positive and negative selection
#  and remove selection variable from each
positives <- mageck[mageck$selection == "positive", -14]
negatives <- mageck[mageck$selection == "negative", -14]
# Compare lfc in both groups
hist(positives$lfc)
hist(negatives$lfc)
summary(positives$lfc)
summary(negatives$lfc)
n(positives$lfc)
library(ggridges)
# Sort values based on p-values to see which selection p-value is lower
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
# Append to mageck data frame as factor
mageck$selection <- as.factor(selection)
summary(mageck$selection)
# Compare lfc across selections
ggplot(mageck, mapping = aes(x = lfc,
group = selection,
fill = selection,
alpha = 0.05)) +
geom_density() +
ggtitle("Log fold change distribution for positive and negative selections")
# Create separate data frames for each positive and negative selection
#  and remove selection variable from each
positives <- mageck[mageck$selection == "positive", -14]
negatives <- mageck[mageck$selection == "negative", -14]
# Compare lfc in both groups
hist(positives$lfc)
hist(negatives$lfc)
summary(positives$lfc)
summary(negatives$lfc)
qqnorm(positives$lfc)
qqnorm(negatives$lfc)
t.test(negatives$lfc, positives$lfc)
str(pathways)
knitr::opts_chunk$set(echo = TRUE)
library(ggpubr)
# Distribution of positive selection fdr
posfdr_plot <- ggplot(mageck, aes(x = pos.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of positive selection fdr values")
# Distribution of negative selection fdr
negfdr_plot <- ggplot(mageck, aes(x = neg.fdr)) +
geom_histogram(bins = 500) +
xlab("fdr") +
ggtitle("Distribution of negative selection fdr values")
ggarrange(posfdr_plot, negfdr_plot)
ggarrange(posfdr_plot, negfdr_plot)
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_density2d_filled() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values")
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_density2d_filled() +
# geom_vline(xintercept = 0.1,
#            color = "red") +
# geom_hline(yintercept = 0.1,
#            color = "red") +
ggtitle("Comparison of positive and negative selection fdr values")
ggplot(mageck, aes(x = pos.fdr,
y = neg.fdr,
alpha = 0.01)) +
geom_density_2d_filled() +
# geom_vline(xintercept = 0.1,
#            color = "red") +
# geom_hline(yintercept = 0.1,
#            color = "red") +
ggtitle("Comparison of positive and negative selection fdr values")
# Compare positive and negative fdr's
ggplot(mageck, aes(x = neg.fdr,
y = pos.fdr,
alpha = 0.01)) +
geom_point() +
geom_vline(xintercept = 0.1,
color = "red") +
geom_hline(yintercept = 0.1,
color = "red") +
ggtitle("Comparison of positive and negative selection fdr values") +
theme(legend.position="none")
View(mageck[1:5,])
?sort
?order
knitr::opts_chunk$set(echo = TRUE)
lfc_sort <- mageck[order(mageck$lfc),]
head(lfc_sort)
View(lfc_sort[1:5,])
lfc_sort <- mageck[order(mageck$lfc, decreasing = TRUE),]
View(lfc_sort[1:5,])
mageck_lfc_sort <- lfc_sort[c(id, lfc),]
mageck_lfc_sort <- cbind(lfc_sort$id, lfc_sort$lfc)
head(mageck_lfc_sort)
install.packages("devtools")
library("devtools")
install_github("GSEA-MSigDB/GSEA_R")
3
table(pathways[1:5,])
?table
?tibble
knitr::opts_chunk$set(echo = TRUE)
view(mageck[1:5,])
View(mageck[1:5,])
View(mageck)
knitr::opts_chunk$set(echo = TRUE)
# Import MAGeCK data set
library(readr)
library(ggplot2)
mageck <- read_delim("mageckRRA.gene_summary.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
# Reassign column names
colnames(mageck) <- c("id",
"num",
"neg.score",
"neg.p_value",
"neg.fdr",
"neg.rank",
"neg.goodsgrna",
"neg.lfc",
"pos.score",
"pos.p_value",
"pos.fdr",
"pos.rank",
"pos.goodsgrna",
"lfc"
)
# Convert goodsgrna to factor
mageck$num <- as.factor(mageck$num)
mageck$neg.goodsgrna <- as.factor(mageck$neg.goodsgrna)
mageck$pos.goodsgrna <- as.factor(mageck$pos.goodsgrna)
# Delete neg.lfc
mageck <- mageck[,-8]
selection <- NULL
# Sort values based on p-values to see which selection p-value is lower
for (i in 1:length(mageck$id)){
if (mageck$neg.p_value[i] > mageck$pos.p_value[i]){
selection[i] <- "positive"
} else {
selection[i] <- "negative"
}
}
# Append to mageck data frame as factor
mageck$selection <- as.factor(selection)
summary(mageck$selection)
# view data summary
summary(mageck)
View(mageck[1:5,])
table(mageck[1:5,])
as.table(mageck[1:5,])
as.data.table(mageck[1:5,])
knitr::kable(mageck[1:5,])
?kable
?GSEA
?GSEABase
example("GeneSet")
source(system.file('extdata', 'Run.GSEA.R', package = 'GSEA'))
?GSEA_R
?GSEABase
?`GSEABase-package`
ls("package:GSEABase")
